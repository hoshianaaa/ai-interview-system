# 面接の公開URL設計メモ

## 前提
- 面接URLは公開URLであり、URLを知っている人がアクセスできる前提で扱う。
- 公開URLはベアラートークン相当のため、推測困難性と失効・再発行が重要になる。

## 設計方針
- 公開URLは内部IDと分離した`publicToken`を使用する。
  - 失効/再発行が容易で、監査ログの追跡もシンプル。
  - 内部IDの漏えいを防ぎ、URLから内部構造が推測されにくい。
- 発行元組織の固定はURLから導出しない。
  - 発行時に`orgId`をDBに保存し、参加・録画保存時はDBの`orgId`を参照する。
  - URLの改ざんによる保存先のすり替えを防止する。

## 実装サマリ
- DB: `Interview.publicToken` と `Interview.orgId` を保持。
- URL: `/interview/<publicToken>` を発行し、参加時は`publicToken`で面接を特定。
- 録画保存: `recordings/orgs/<orgId>/...` に保存し、組織単位で分離。
- 管理画面: `orgId`で一覧をフィルタし、他組織の録画URLは取得不可。

## 運用の検討事項
- `publicToken`の失効・再発行フロー（例: 期限切れ、誤送信時の再発行）。
- 再利用防止（既に実装済みの`status`/`usedAt`チェックの継続利用）。
- 監査ログ（発行/アクセス/再発行の履歴）。
